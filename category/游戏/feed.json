{
    "version": "https://jsonfeed.org/version/1",
    "title": "VPS探索者 • All posts by \"游戏\" category",
    "description": "",
    "home_page_url": "http://www.seekvps.com",
    "items": [
        {
            "id": "http://www.seekvps.com/2024/01/26/%E5%A6%82%E4%BD%95%E5%9C%A8Ubuntu20.04%E6%90%AD%E5%BB%BA%E5%B9%BB%E5%85%BD%E5%B8%95%E9%B2%81%E6%9C%8D%E5%8A%A1%E5%99%A8/",
            "url": "http://www.seekvps.com/2024/01/26/%E5%A6%82%E4%BD%95%E5%9C%A8Ubuntu20.04%E6%90%AD%E5%BB%BA%E5%B9%BB%E5%85%BD%E5%B8%95%E9%B2%81%E6%9C%8D%E5%8A%A1%E5%99%A8/",
            "title": "如何在Ubuntu20.04搭建幻兽帕鲁服务器",
            "date_published": "2024-01-26T01:07:14.000Z",
            "content_html": "<h1 id=\"购买服务器前需要了解的\"><a href=\"#购买服务器前需要了解的\" class=\"headerlink\" title=\"购买服务器前需要了解的\"></a>购买服务器前需要了解的</h1><p>幻兽帕鲁这个游戏极其不靠谱<br>虽然真的好玩，但是作为一款偏向联机的游戏太失败了<br>官方服务器崩溃、回档、甚至删档<br>自建服务器也同样会遇到这些情况<br>这都和游戏服务端的垃圾内存管理有关<br>它的内存会不断增加，不会清理，直到内存超过服务器最大限度<br>游戏崩溃！<br>无论是8g 16g 32g 就算你是128g的独立服务器<br>玩久了一样会把内存吃满满，然后服务端崩溃<br>在官方彻底修补解决前，我们是没有办法根治的<br>因此我们需要做好频繁崩溃的准备，也要做好崩溃前游戏丢包卡顿的准备<br>服务器配置8g起步，上不封顶</p>\n<p>购买完服务器之后，将其重装成Ubuntu20.04系统（因为我是这个系统）<br>我们需要做到以下几点</p>\n<ul>\n<li>扩充swap，变相增加内存</li>\n<li>安装服务端（Steamcmd和Palserver）</li>\n<li>配置Systemd</li>\n<li>修改PalWorldSettings.ini文件</li>\n<li>熟悉管理员命令</li>\n</ul>\n<h1 id=\"创建swap\"><a href=\"#创建swap\" class=\"headerlink\" title=\"创建swap\"></a>创建swap</h1><p>创建一个新的 swap 文件（如果需要）：</p>\n<pre><code>sudo fallocate -l 20G /swapfile\n</code></pre>\n<p>这会在根目录下创建一个名为 swapfile 的 20GB 大小的 swap 文件。<br>设置新 swap 文件的权限：</p>\n<pre><code>sudo chmod 600 /swapfile\n</code></pre>\n<p>将文件转换为 swap 文件：</p>\n<pre><code>sudo mkswap /swapfile\n</code></pre>\n<p>启用新的 swap 文件：</p>\n<pre><code>sudo swapon /swapfile\n</code></pre>\n<p>查看是否成功启用了新的 swap 文件：</p>\n<pre><code>sudo swapon --show\n</code></pre>\n<p>永久性配置，以便在系统重新启动时自动加载新的 swap 文件：<br>打开 &#x2F;etc&#x2F;fstab文件：</p>\n<pre><code>vim /etc/fstab\n</code></pre>\n<p>在文件末尾添加以下行：</p>\n<pre><code>/swapfile none swap sw 0 0\n</code></pre>\n<p>最后，刷新文件系统表：</p>\n<pre><code>sudo swapon --all --verbose\n</code></pre>\n<h1 id=\"服务端搭建\"><a href=\"#服务端搭建\" class=\"headerlink\" title=\"服务端搭建\"></a>服务端搭建</h1><p>按顺序输入代码</p>\n<h1 id=\"添加-32-位架构支持和安装相关库\"><a href=\"#添加-32-位架构支持和安装相关库\" class=\"headerlink\" title=\"添加 32 位架构支持和安装相关库\"></a>添加 32 位架构支持和安装相关库</h1><pre><code>sudo dpkg --add-architecture i386\nsudo apt-get update\nsudo apt-get install lib32gcc1 lib32stdc++6\n</code></pre>\n<h1 id=\"创建一个新用户并安装-screen-工具，这里会要求创建steam用户的密码\"><a href=\"#创建一个新用户并安装-screen-工具，这里会要求创建steam用户的密码\" class=\"headerlink\" title=\"创建一个新用户并安装 screen 工具，这里会要求创建steam用户的密码\"></a>创建一个新用户并安装 screen 工具，这里会要求创建steam用户的密码</h1><pre><code>adduser steam\n</code></pre>\n<h1 id=\"切换到新用户\"><a href=\"#切换到新用户\" class=\"headerlink\" title=\"切换到新用户\"></a>切换到新用户</h1><pre><code>su -ls /bin/bash steam\n</code></pre>\n<h1 id=\"下载并安装-SteamCMD\"><a href=\"#下载并安装-SteamCMD\" class=\"headerlink\" title=\"下载并安装 SteamCMD\"></a>下载并安装 SteamCMD</h1><pre><code>wget https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz\ntar -xvzf steamcmd_linux.tar.gz\n./steamcmd.sh\n</code></pre>\n<h1 id=\"设置-PalServer-安装目录并使用-SteamCMD-登录并更新-PalServer\"><a href=\"#设置-PalServer-安装目录并使用-SteamCMD-登录并更新-PalServer\" class=\"headerlink\" title=\"设置 PalServer 安装目录并使用 SteamCMD 登录并更新 PalServer\"></a>设置 PalServer 安装目录并使用 SteamCMD 登录并更新 PalServer</h1><pre><code>force_install_dir /home/steam/PalServer\nlogin anonymous\napp_update 2394010 validate\nquit\n</code></pre>\n<h1 id=\"进入-PalServer-目录\"><a href=\"#进入-PalServer-目录\" class=\"headerlink\" title=\"进入 PalServer 目录\"></a>进入 PalServer 目录</h1><pre><code>cd PalServer\n</code></pre>\n<h1 id=\"创建-Steam-SDK-目录并复制-steamclient-so-文件\"><a href=\"#创建-Steam-SDK-目录并复制-steamclient-so-文件\" class=\"headerlink\" title=\"创建 Steam SDK 目录并复制 steamclient.so 文件\"></a>创建 Steam SDK 目录并复制 steamclient.so 文件</h1><pre><code>mkdir -p ~/.steam/sdk64/\ncp linux64/steamclient.so ~/.steam/sdk64/\n</code></pre>\n<h1 id=\"运行-PalServer-脚本，出现AppID服务器即运行成功\"><a href=\"#运行-PalServer-脚本，出现AppID服务器即运行成功\" class=\"headerlink\" title=\"运行 PalServer 脚本，出现AppID服务器即运行成功\"></a>运行 PalServer 脚本，出现AppID服务器即运行成功</h1><pre><code>./PalServer.sh port=8211\n</code></pre>\n<h1 id=\"Systemd配置\"><a href=\"#Systemd配置\" class=\"headerlink\" title=\"Systemd配置\"></a>Systemd配置</h1><p>需要执行以下步骤：<br>打开 systemd 服务单元文件：</p>\n<pre><code>sudo vim /etc/systemd/system/palserver.service\n</code></pre>\n<p>在 Vim 中，按 i 进入插入模式，然后添加或修改文件内容。以下是一个示例 PalServer systemd 服务单元文件的内容，包含了添加 Vim 的配置：<br>    [Unit]<br>    Description&#x3D;Palworld Server<br>    Wants&#x3D;network-online.target<br>    After&#x3D;syslog.target network.target nss-lookup.target network-online.target</p>\n<pre><code>[Service]\nWorkingDirectory=/home/steam/PalServer\n\nExecStart=/bin/bash -c &quot;/home/steam/PalServer/PalServer.sh -port=8211 -players=16 -useperfthreads -NoAsyncLoadingThread -UseMultithreadForDS&quot;\n\nLimitNOFILE=100000\nExecReload=/bin/kill -s HUP $MAINPID\nExecStop=/bin/kill -s INT $MAINPID\n\nRestart=always\nRestartSec=10\n\nUser=steam\nGroup=steam\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<p>其中，服务器人数上限和服务器停止后等待重启秒数都可以自由设置<br>在编辑完成后，按 Esc 键退出插入模式<br>输入 :wq 并按 Enter 保存并退出 Vim<br>systemd 提供了更强大的服务管理功能，包括启动、停止、重启、状态监控等，而无需依赖终端窗口<br>通过 systemd，你可以使用以下命令来管理 PalServer 服务：<br>启动服务：</p>\n<pre><code>sudo systemctl start palserver\n</code></pre>\n<p>停止服务：</p>\n<pre><code>sudo systemctl stop palserver\n</code></pre>\n<p>重启服务：</p>\n<pre><code>sudo systemctl restart palserver\n</code></pre>\n<p>查看服务状态：</p>\n<pre><code>sudo systemctl status palserver\n</code></pre>\n<p>设置服务开机自启动 ：</p>\n<pre><code>sudo systemctl enable palserver\n</code></pre>\n<p>禁用服务开机自启动：</p>\n<pre><code>sudo systemctl disable palserver\n</code></pre>\n<p>重新加载 systemd 以使更改生效（vim修改后报错时）：</p>\n<pre><code>sudo systemctl daemon-reload\n</code></pre>\n<h1 id=\"修改配置文件\"><a href=\"#修改配置文件\" class=\"headerlink\" title=\"修改配置文件\"></a>修改配置文件</h1><p>本来是很麻烦的事情<br>但是有台湾友人倾情写了个网站方便大众<br>PalWorld Settings Generator v0.11 (dysoncheng.github.io)<br><a href=\"https://dysoncheng.github.io/PalWorldSettingGenerator/setting.html\">https://dysoncheng.github.io/PalWorldSettingGenerator/setting.html</a></p>\n<p>这个网站可以直接输入你想要的设定然后输出PalWorldSettings.ini文件<br>把目录&#x2F;home&#x2F;steam&#x2F;PalServer&#x2F;Pal&#x2F;Saved&#x2F;Config&#x2F;LinuxServer&#x2F;文件夹中的文件替换掉即可<br>熟悉管理员命令<br>最后的最后，成为腐竹当然要能掌控全局！<br>虽然管理员命令不是很多，但有些还是很重要的<br>在游戏内对话框（按回车打开对话框）中输入&#x2F;AdminPassword 管理员密码<br>即可成为管理员<br>之后在对话框可以输入的命令有：<br>&#x2F;Shutdown {Seconds} {MessageText} 服务器关闭数秒后将收到您的 MessageText 通知<br>&#x2F;DoExit 强制停止服务器<br>&#x2F;Broadcast {MessageText} 向服务器中的所有玩家发送消息<br>&#x2F;KickPlayer {SteamID} 将玩家从服务器中踢出<br>&#x2F;BanPlayer {SteamID} 从服务器禁止玩家<br>&#x2F;TeleportToPlayer {SteamID} 传送到目标玩家的当前位置<br>&#x2F;TeleportToMe {SteamID} 目标玩家传送到您当前的位置<br>&#x2F;ShowPlayers 显示所有已连接玩家的信息<br>&#x2F;Info 显示服务器信息<br>&#x2F;Save 保存世界数据<br>&#x2F;Save可以在停服前手动保存存档，减少坏档的机率，&#x2F;Shutdown 60 可以在服务器卡顿时，无须操作终端软件，在服务器内关闭游戏端，并且通过配合systemd实现自动重启游戏端<br>2.开开心心的玩吧！<br>服务器准备到这种程度，后续发生的一切都随缘啦<br>该坏还是坏，该崩还是崩<br>只能期待自己运气好点，官方早点更新！</p>\n",
            "tags": [
                "幻兽帕鲁"
            ]
        }
    ]
}