<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>http://www.seekvps.com</id>
    <title>VPS探索者 • Posts by &#34;iptables&#34; category</title>
    <link href="http://www.seekvps.com" />
    <updated>2023-10-12T02:30:44.000Z</updated>
    <category term="akile.io" />
    <category term="Debian" />
    <category term="MarkDownPad2" />
    <category term="OVH" />
    <category term="bero-host.de" />
    <category term="iptables" />
    <category term="prohosting24.de" />
    <category term="skrime.eu" />
    <category term="搬瓦工" />
    <category term="dogyun" />
    <category term="软考" />
    <entry>
        <id>http://www.seekvps.com/2023/10/12/iptables%E8%87%AA%E5%8A%A8%E5%B1%8F%E8%94%BD%E8%AE%BF%E9%97%AE%E7%BD%91%E7%AB%99%E9%A2%91%E7%B9%81%E7%9A%84IP/</id>
        <title>iptables自动屏蔽访问网站频繁的IP</title>
        <link rel="alternate" href="http://www.seekvps.com/2023/10/12/iptables%E8%87%AA%E5%8A%A8%E5%B1%8F%E8%94%BD%E8%AE%BF%E9%97%AE%E7%BD%91%E7%AB%99%E9%A2%91%E7%B9%81%E7%9A%84IP/"/>
        <content type="html">&lt;h1 id=&#34;iptables自动屏蔽访问网站频繁的IP&#34;&gt;&lt;a href=&#34;#iptables自动屏蔽访问网站频繁的IP&#34; class=&#34;headerlink&#34; title=&#34;iptables自动屏蔽访问网站频繁的IP&#34;&gt;&lt;/a&gt;iptables自动屏蔽访问网站频繁的IP&lt;/h1&gt;&lt;pre class=&#34;line-numbers language-java&#34; data-language=&#34;java&#34;&gt;&lt;code class=&#34;language-java&#34;&gt;
场景：恶意访问&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;安全防范

&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;）屏蔽每分钟访问超过&lt;span class=&#34;token number&#34;&gt;200&lt;/span&gt;的&lt;span class=&#34;token constant&#34;&gt;IP&lt;/span&gt;

方法&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;：根据访问日志（&lt;span class=&#34;token class-name&#34;&gt;Nginx&lt;/span&gt;为例）

#&lt;span class=&#34;token operator&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;bin&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;bash
&lt;span class=&#34;token constant&#34;&gt;DATE&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;$&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;date &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;%&lt;/span&gt;d&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;%&lt;/span&gt;b&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;H&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;M&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token constant&#34;&gt;ABNORMAL_IP&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;$&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;tail &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;n5000 access&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;log &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;grep $&lt;span class=&#34;token constant&#34;&gt;DATE&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;awk &#39;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;a&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;$&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;END&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;i in a&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;a&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;print i&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&#39;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
#先tail防止文件过大，读取慢，数字可调整每分钟最大的访问量。awk不能直接过滤日志，因为包含特殊字符。
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;IP&lt;/span&gt; in $&lt;span class=&#34;token constant&#34;&gt;ABNORMAL_IP&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;do&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt; $&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;iptables &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;vnL &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;grep &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;c &lt;span class=&#34;token string&#34;&gt;&#34;$IP&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;eq &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; then
        iptables &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;I&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;INPUT&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;s $&lt;span class=&#34;token constant&#34;&gt;IP&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;j &lt;span class=&#34;token constant&#34;&gt;DROP&lt;/span&gt;
    fi
done
方法&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;：通过&lt;span class=&#34;token constant&#34;&gt;TCP&lt;/span&gt;建立的连接

#&lt;span class=&#34;token operator&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;bin&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;bash
&lt;span class=&#34;token constant&#34;&gt;ABNORMAL_IP&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;$&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;netstat &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;an &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;awk &#39;$&lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;80&lt;/span&gt;$&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; $&lt;span class=&#34;token number&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;ESTABLISHED&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;gsub&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;$&lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;a&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;$&lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;END&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;i in a&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;a&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;print i&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&#39;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
#gsub是将第五列（客户端&lt;span class=&#34;token constant&#34;&gt;IP&lt;/span&gt;）的冒号和端口去掉
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;IP&lt;/span&gt; in $&lt;span class=&#34;token constant&#34;&gt;ABNORMAL_IP&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;do&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt; $&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;iptables &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;vnL &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;grep &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;c &lt;span class=&#34;token string&#34;&gt;&#34;$IP&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;eq &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; then
        iptables &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;I&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;INPUT&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;s $&lt;span class=&#34;token constant&#34;&gt;IP&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;j &lt;span class=&#34;token constant&#34;&gt;DROP&lt;/span&gt;
    fi
done

&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;）屏蔽每分钟&lt;span class=&#34;token constant&#34;&gt;SSH&lt;/span&gt;尝试登录超过&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;次的&lt;span class=&#34;token constant&#34;&gt;IP&lt;/span&gt;

方法&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;：通过lastb获取登录状态&lt;span class=&#34;token operator&#34;&gt;:&lt;/span&gt;

#&lt;span class=&#34;token operator&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;bin&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;bash
&lt;span class=&#34;token constant&#34;&gt;DATE&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;$&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;date &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;%a %b %e %H:%M&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; #星期月天时分  &lt;span class=&#34;token operator&#34;&gt;%&lt;/span&gt;e单数字时显示&lt;span class=&#34;token number&#34;&gt;7&lt;/span&gt;，而&lt;span class=&#34;token operator&#34;&gt;%&lt;/span&gt;d显示&lt;span class=&#34;token number&#34;&gt;07&lt;/span&gt;
&lt;span class=&#34;token constant&#34;&gt;ABNORMAL_IP&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;$&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;lastb &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;grep &lt;span class=&#34;token string&#34;&gt;&#34;$DATE&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;awk &#39;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;a&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;$&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;span class=&#34;token constant&#34;&gt;END&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;i in a&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;a&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;print i&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&#39;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;IP&lt;/span&gt; in $&lt;span class=&#34;token constant&#34;&gt;ABNORMAL_IP&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;do&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt; $&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;iptables &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;vnL &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;grep &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;c &lt;span class=&#34;token string&#34;&gt;&#34;$IP&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;eq &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; then
        iptables &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;I&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;INPUT&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;s $&lt;span class=&#34;token constant&#34;&gt;IP&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;j &lt;span class=&#34;token constant&#34;&gt;DROP&lt;/span&gt;
    fi
done
方法&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;：通过日志获取登录状态

#&lt;span class=&#34;token operator&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;bin&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;bash
&lt;span class=&#34;token constant&#34;&gt;DATE&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;$&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;date &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;%b %d %H&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;token constant&#34;&gt;ABNORMAL_IP&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;$(tail -n10000 /var/log/auth.log |grep &#34;&lt;/span&gt;$&lt;span class=&#34;token constant&#34;&gt;DATE&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34; |awk &#39;/Failed/&amp;#123;a[$(NF-3)]++&amp;#125;END&amp;#123;for(i in a)if(a[i]&gt;5)print i&amp;#125;&#39;)&#34;&lt;/span&gt;
&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;IP&lt;/span&gt; in $&lt;span class=&#34;token constant&#34;&gt;ABNORMAL_IP&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;do&lt;/span&gt;
    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt; $&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;iptables &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;vnL &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;grep &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;c &lt;span class=&#34;token string&#34;&gt;&#34;$IP&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;eq &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt; then
        iptables &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;token constant&#34;&gt;INPUT&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;s $&lt;span class=&#34;token constant&#34;&gt;IP&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;j &lt;span class=&#34;token constant&#34;&gt;DROP&lt;/span&gt;
        echo &lt;span class=&#34;token string&#34;&gt;&#34;$(date +&#34;&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;F&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;token class-name&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;) - iptables -A INPUT -s $IP -j DROP&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;&gt;&gt;&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;ssh&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;login&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;limit&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;log
    fi
done&lt;span aria-hidden=&#34;true&#34; class=&#34;line-numbers-rows&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;</content>
        <category term="iptables" />
        <updated>2023-10-12T02:30:44.000Z</updated>
    </entry>
</feed>
